<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Consentimiento Informado - Procedimientos Quirúrgicos</title>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.5/dist/signature_pad.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <style>
        :root { --primary-color:#3a7ca5; --secondary-color:#f8f9fa; --accent-color:#63c5da; --text-color:#2c3e50; --border-color:#d1e7f0; --shadow-color:rgba(0,0,0,0.1); }
        body{font-family:'Segoe UI',Arial,sans-serif;margin:0;padding:20px;background:#f5f7fa;color:var(--text-color);}
        .container{width:800px;margin:0 auto;padding:30px;background:white;border:1px solid var(--border-color);box-shadow:0 5px 20px var(--shadow-color);border-radius:12px;margin-bottom:40px;}
        .header{display:flex;justify-content:space-between;align-items:center;border-bottom:3px solid var(--accent-color);padding-bottom:15px;margin-bottom:20px;}
        .logo{max-width:80px;border-radius:10px;box-shadow:0 2px 5px var(--shadow-color);}
        h1{flex:1;text-align:center;color:var(--primary-color);font-size:1.6rem;text-shadow:1px 1px 2px var(--shadow-color);}
        .date-short{font-size:0.9rem;font-weight:bold;}
        p, ul{margin-bottom:20px;line-height:1.6;text-align:justify;}
        ul{padding-left:20px;}
        label{font-weight:bold;}
        input[type="text"]{border:none;background:transparent;font-weight:bold;min-height:35px;padding:8px 12px;}
        input[type="text"]:focus{outline:none;background:var(--secondary-color);}
        .notice{background:var(--secondary-color);padding:15px;border-radius:6px;margin-bottom:20px;}
        .signature-area{display:flex;justify-content:center;margin-top:40px;}
        .firma-container{display:flex;flex-direction:column;align-items:center;flex:1;}
        .signature-box{background:var(--secondary-color);padding:10px;border-radius:5px;width:100%;text-align:center;margin-bottom:10px;font-weight:500;}
        .signature-pad{width:100%;height:200px;border:2px dashed var(--border-color);border-radius:8px;background:white;box-shadow:0 2px 8px var(--shadow-color);}
        .signature-buttons{margin-top:10px;}
        .pdf-button-container{text-align:center;margin-top:30px;}
        .pdf-button{padding:12px 25px;background:#4CAF50;color:white;border:none;border-radius:6px;font-weight:bold;cursor:pointer;}
        .pdf-button:hover{background:#45a049;}
        /* Menú principal */
        .main-menu-container {
            width: 100%;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            margin-bottom: 40px;
        }
        .main-menu {
            background: linear-gradient(120deg, #e3f2fd 0%, #f8f9fa 100%);
            border-radius: 18px;
            box-shadow: 0 4px 24px var(--shadow-color);
            padding: 32px 24px 24px 24px;
            max-width: 700px;
            width: 100%;
            text-align: center;
            margin-top: 20px;
        }
        .menu-logo {
            max-width: 90px;
            border-radius: 12px;
            margin-bottom: 10px;
            box-shadow: 0 2px 8px var(--shadow-color);
        }
        .main-menu h2 {
            color: var(--primary-color);
            margin-bottom: 28px;
            font-size: 1.5rem;
            letter-spacing: 1px;
        }
        .menu-options {
            display: flex;
            flex-wrap: wrap;
            gap: 18px;
            justify-content: center;
        }
        .menu-card {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 200px;
            height: 70px;
            background: white;
            border-radius: 12px;
            box-shadow: 0 2px 10px var(--shadow-color);
            color: var(--primary-color);
            font-weight: 600;
            font-size: 1.1rem;
            text-decoration: none;
            transition: transform 0.18s, box-shadow 0.18s, background 0.18s;
            border: 2px solid var(--border-color);
            position: relative;
        }
        .menu-card:hover {
            background: var(--accent-color);
            color: white;
            transform: translateY(-4px) scale(1.04);
            box-shadow: 0 6px 18px var(--shadow-color);
            border-color: var(--primary-color);
        }
        .menu-card.anestesia { border-left: 6px solid #3a7ca5; }
        .menu-card.cirugia { border-left: 6px solid #e67e22; }
        .menu-card.emergencias { border-left: 6px solid #c0392b; }
        .menu-card.internamiento { border-left: 6px solid #16a085; }
        .menu-card.transfusion { border-left: 6px solid #8e44ad; }
        .menu-card.cesarea { border-left: 6px solid #d35400; }
        .menu-card.eutanasia { border-left: 6px solid #b71c1c; }
        @media (max-width: 800px) {
            .main-menu { max-width: 98vw; }
            .menu-card { width: 98vw; max-width: 320px; }
        }
    </style>
</head>
<body>
    <!-- Menú principal de selección de plantillas -->
    <div class="main-menu-container">
        <div class="main-menu">
            <img src="empresa.jpg" alt="Veterinaria San Martin de Porres" class="menu-logo">
            <h2>SELECCIONA UNA PLANTILLA</h2>
            <div class="menu-options">
                <a href="index.html" class="menu-card anestesia">
                    <span>Autorización para Anestesia</span>
                </a>
                <a href="consentimiento_cirugia.html" class="menu-card cirugia">
                    <span>Consentimiento Cirugía</span>
                </a>
                <a href="Emergencias_Plantilla.html" class="menu-card emergencias">
                    <span>Emergencias</span>
                </a>
                <a href="internamiento.html" class="menu-card internamiento">
                    <span>Internamiento</span>
                </a>
                <a href="transfusion.html" class="menu-card transfusion">
                    <span>Transfusión</span>
                </a>
                <a href="consentimiento_cesarea.html" class="menu-card cesarea">
                    <span>Consentimiento Cesárea</span>
                </a>
                <a href="consentimiento_eutanasia.html" class="menu-card eutanasia">
                    <span>Consentimiento Eutanasia</span>
                </a>
                <a href="hoja_lab.html" class="menu-card lab">
                    <span>Hoja de Laboratorio</span>
                </a>
            </div>
        </div>
    </div>
    <div class="container" id="surgContent">
        <div class="header">
            <img src="empresa.jpg" alt="Veterinaria San Martin de Porres" class="logo">
            <h1>CONSENTIMIENTO INFORMADO<BR>
            VETERINARIA SAN MARTIN DE PORRES</h1>
            <div id="shortDate" class="date-short"></div>
        </div>
        <p><strong>Información del Propietario:</strong></p>
        <p>Nombre del Propietario: <input type="text" id="ownerName" placeholder="Nombre del propietario" required></p>
        <p>Cédula: <input type="text" id="ownerId" placeholder="Cédula" required></p>
        <p><strong>Información del Paciente:</strong></p>
        <p>Nombre: <input type="text" id="petName" placeholder="Nombre del paciente" required></p>
        <p>Especie: <input type="text" id="petSpecies" placeholder="Especie" required></p>
        <p>Raza: <input type="text" id="petBreed" placeholder="Raza" required></p>
        <p>Sexo: <input type="text" id="petSex" placeholder="Sexo" required></p>
        <p>Edad: <input type="text" id="petAge" placeholder="Edad" required></p>
        <p>Peso: <input type="text" id="petWeight" placeholder="Peso" required></p>
        <p><strong>Procedimiento a Realizar:</strong> <input type="text" id="surgType" placeholder="Tipo de procedimiento" required></p>
        <p>
            El paciente será sometido a una <input type="text" id="surgType" placeholder="Procedimiento" required>, procedimiento quirúrgico que consiste en <input type="text" id="surgDesc" placeholder="Descripción del procedimiento" required>. Esta intervención se realiza cuando existen condiciones médicas graves que comprometen la salud del paciente, como infecciones severas, traumatismos, tumores, glaucoma avanzado u otras patologías que no pueden ser tratadas de manera conservadora.
        </p>
        <p>
            <strong>Recomendación Postquirúrgica:</strong> Por indicación médica, se recomienda que el paciente permanezca hospitalizado bajo observación por un período aproximado de 24 horas. Este tiempo es esencial para monitorear cualquier signo de complicación, como sangrado, inflamación severa, dolor incontrolado o reacciones adversas a los medicamentos. Además, permite garantizar la estabilización completa del paciente tras la cirugía y la administración de los cuidados postoperatorios necesarios.
        </p>
        <p><strong>Posibles Riesgos y Complicaciones:</strong></p>
        <ul>
            <li><strong>Sangrado Postquirúrgico:</strong> Riesgo de hemorragia en el área quirúrgica.</li>
            <li><strong>Infección:</strong> Aunque se aplican protocolos de esterilización estrictos, existe una posibilidad de infección en el área de la incisión.</li>
            <li><strong>Inflamación:</strong> Hinchazón en la zona intervenida que puede requerir manejo médico adicional.</li>
            <li><strong>Dolor postoperatorio:</strong> El cual será manejado con analgésicos según la prescripción médica.</li>
            <li><strong>Reacciones a la anestesia:</strong> Aunque se realizan evaluaciones previas, siempre hay un riesgo mínimo de reacciones adversas.</li>
            <li><strong>Cicatrización inadecuada:</strong> En casos poco frecuentes, puede haber problemas en la recuperación de la herida quirúrgica.</li>
        </ul>
        <p><strong>Compromiso del Propietario:</strong></p>
        <ul>
            <li>Administrar los medicamentos recetados en las dosis y horarios indicados.</li>
            <li>Evitar que el paciente manipule el área quirúrgica, utilizando un collar isabelino si es necesario.</li>
            <li>Acudir a las citas de revisión programadas para valorar la evolución postquirúrgica.</li>
            <li>Informar de inmediato a la clínica en caso de observar signos anormales como fiebre, apatía, pérdida de apetito o sangrado persistente.</li>
        </ul>
        <p><strong>Declaración del Propietario:</strong></p>
        <p>
            Yo, <input type="text" id="declOwner" placeholder="Nombre del propietario" required>, en mi calidad de propietario del paciente <input type="text" id="declPet" placeholder="Nombre del paciente" required>, declaro que:
        </p>
        <ul>
            <li>He sido informado de manera clara sobre la naturaleza del procedimiento, sus riesgos, beneficios y cuidados postoperatorios.</li>
            <li>He tenido la oportunidad de realizar preguntas y estas han sido respondidas a mi satisfacción.</li>
            <li>Autorizo la realización de la enucleación al paciente <input type="text" id="declProcedure" placeholder="Procedimiento" required>, así como su hospitalización posterior según las recomendaciones médicas.</li>
        </ul>
        <p>Firmado a las <span id="surgTime"></span> horas, el día <span id="surgDay"></span> del mes <span id="surgMonth"></span> del año <span id="surgYear"></span>.</p>
        <div class="signature-area">
            <div class="firma-container">
                <div class="signature-box">Firma del propietario</div>
                <canvas class="signature-pad" id="surgSigPad"></canvas>
                <div class="signature-buttons"><button type="button" onclick="clearSignature('surgSigPad')">Limpiar</button></div>
            </div>
        </div>
        <div class="pdf-button-container"><button class="pdf-button" onclick="generatePDF()">Generar PDF</button></div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded',()=>{
            const now=new Date();
            document.getElementById('shortDate').textContent=now.toLocaleDateString('es-ES');
            document.getElementById('surgTime').textContent=now.toLocaleTimeString([], {hour:'2-digit',minute:'2-digit'});
            document.getElementById('surgDay').textContent=now.getDate();
            document.getElementById('surgMonth').textContent=now.toLocaleString('es-ES',{month:'long'});
            document.getElementById('surgYear').textContent=now.getFullYear();
            const c=document.getElementById('surgSigPad');
            function rz(canvas){const r=Math.max(window.devicePixelRatio||1,2);canvas.width=canvas.offsetWidth*r;canvas.height=canvas.offsetHeight*r;canvas.getContext('2d').scale(r,r);}rz(c);
            window.signaturePads={surgSigPad:new SignaturePad(c,{backgroundColor:'rgba(255,255,255,0)',penColor:'rgb(0,0,100)'})};window.addEventListener('resize',()=>rz(c));
        });
        function clearSignature(id){window.signaturePads[id].clear();}
        async function generatePDF(){
            const {jsPDF}=window.jspdf;const pdf=new jsPDF('p','mm','a4');const cont=document.getElementById('surgContent');
            const canvas=await html2canvas(cont,{scale:1.5,useCORS:true,backgroundColor:'#fff'});
            const img=canvas.toDataURL('image/jpeg',0.7);const imgW=140,pgH=297;const imgH=(canvas.height*imgW)/canvas.width;
            const x=(pdf.internal.pageSize.getWidth()-imgW)/2;const y=(pgH-imgH)/2;
            let ownerLastName = '';
            const ownerName = document.getElementById('ownerName').value;
            const petName = document.getElementById('petName').value;
            if (ownerName && ownerName.trim().split(' ').length > 1) {
                const parts = ownerName.trim().split(' ');
                ownerLastName = parts.length > 2 ? parts[parts.length - 1] : parts[1];
            }
            pdf.addImage(img,'JPEG',x,y,imgW,imgH);
            pdf.save(`Consentimiento_Cirugia_${petName}_${ownerLastName}.pdf`);
        }
    </script>
</body>
</html>